
{{ 'KitBuilder.js' | asset_url | script_tag }}

<div class="KitBuilder">
    <h1>{{ section.settings.headline }}</h1>
    <div class = main>
        <h2>current product</h2>
        {% assign defaultProduct = all_products[section.blocks[0].settings.product1] %}
        {% assign defaultProductImage = defaultProduct.featured_image %}
        <img src = "{{defaultProductImage.src | image_url: width: 200}}" id = "featuredproductimage" height="100px" width="100px">
        <h3 id="featuredproductname">{{defaultProduct.title}}</h3>
        <h4 id="featuredproductdesc">{{defaultProduct.description}}</h4>
        <h3 id="featuredproductprice">{{defaultProduct.price}}</h3>
        <button onclick="checkout()">Add All to Cart</button>
    </div>
    <div class = kits>
        {% for block in section.blocks %}
            <div id = "section{{forloop.index}}" class = "kitsection">
                <h2>{{ block.settings.SectionHeader }}</h2>

                {% if block.settings.product1.id != blank %}
                {% assign product1 = all_products[block.settings.product1] %}
                <div class = "productcard" onclick="selected({{ forloop.index }}, this, {{product1.id}}, {{product1.variants.first.id}} )">
                    <div class = "productimage">{{product1.featured_image | image_url: width: 200 | image_tag}}</div>
                    <div class = "productinfo"> 
                        <span>{{ product1.title }}</span>
                    </div>
                </div>
                {% endif %}

                {% if block.settings.product2.id != blank %}
                {% assign product2 = all_products[block.settings.product2] %}
                <div class = "productcard" onclick="selected({{ forloop.index }}, this, {{product2.id}}, {{product2.variants.first.id}})">
                    <div class = "productimage">{{product2.featured_image | image_url: width: 200 | image_tag}}</div>
                    <div class = "productinfo"> 
                        <span>{{ product2.title }}</span>
                    </div>
                </div>
                {% endif %}

                {% if block.settings.product3.id != blank %}
                {% assign product3 = all_products[block.settings.product3] %}
                <div class = "productcard" onclick="selected({{ forloop.index }}, this, {{product3.id}}, {{product3.variants.first.id}})">
                    <div class = "productimage">{{product3.featured_image | image_url: width: 200 | image_tag}}</div>
                    <div class = "productinfo"> 
                        <span>{{ product3.title }}</span>
                    </div>
                </div>
                {% endif %}

                {% if block.settings.product4.id != blank %}
                {% assign product4 = all_products[block.settings.product4] %} 
                <div class = "productcard" onclick="selected({{ forloop.index }}, this, {{product4.id}}, {{product4.variants.first.id}})">
                    <div class = "productimage">{{product4.featured_image | image_url: width: 200 | image_tag}}</div>
                    <div class = "productinfo"> 
                        <span>{{ product4.title }}</span>
                    </div>
                </div>
                {% endif %}

                <div class = "productcard" onclick="selected({{ forloop.index }}, this, 0, 0)">
                    {% if section.settings.noProductImage != blank %}
                        <div class = "productimage" >{{section.settings.noProductImage | image_url: width: 200 | image_tag}}</div>
                    {% else %}
                        <div class = "noImage"></div>
                    {% endif %}
                    <div class = "productinfo"> 
                        <span>No {{block.settings.SectionHeader}}</span>
                    </div>
                </div>
            </div>
        {%endfor%}
    </div>
</div>

{%stylesheet%}
.KitBuilder{
    display: flex;
}
.main{
    width: 50%;
    background: red;
}
.kits{
    width: 50%;
    background: blue;
}
.kitsection{
    display: flex;
}
.productcard {
    background-color: grey;
    width: 200px;
    height: 300px;
    margin: 40px;
}
.productinfo{
    size: small;
    width: 100%;
    height: 100%;
}
.productimage{
    width: 200px;
    height: 200px;
}
.productcard.selected {
    background-color: white;
}
.noImage{
    background-color: black;
    width: 200px;
    height: 200px;
}
{%endstylesheet%}



{% schema %}
    {
        "name": "Kit-Builder",
        "settings": [
            {
                "type": "text",
                "label": "Headline",
                "id": "headline"
            },
            {
                "type": "image_picker",
                "label": "No Product Image",
                "id": "noProductImage"
            }
        ],
        "max_blocks": 6,
        "blocks":[
            {
                "name": "Kit Section",
                "type": "Kit-Section",
                "settings":[
                    {
                        "type": "text",
                        "label": "Section Header",
                        "id": "SectionHeader"
                    },
                    {
                        "type": "product",
                        "label": "Product",
                        "id": "product1"
                    },
                    {
                        "type": "product",
                        "label": "Product",
                        "id": "product2"
                    },
                    {
                        "type": "product",
                        "label": "Product",
                        "id": "product3"
                    },
                    {
                        "type": "product",
                        "label": "Product",
                        "id": "product4"
                    }
                ]                            
            }
        ],
        "presets": [
            {"name": "Kit-Builder"}
        ]
    }
{% endschema %}